# n8n Custom Node Development Guide

## Project Structure
- **nodes/**: Node implementations (.node.ts for logic, .node.json for metadata)
- **credentials/**: Authentication definitions (.credentials.ts files)
- **dist/**: Compiled output (generated by `npm run build`)
- Single package with multiple nodes listed in package.json "n8n.nodes"

## Node Architecture
- **INodeType class**: Extends with `description` (INodeTypeDescription) and `execute` method
- **description**: Defines UI properties, inputs/outputs, credentials, display options
- **execute**: Processes items array, returns INodeExecutionData[][] (array of arrays for multiple outputs)
- **Data flow**: Loop over `this.getInputData()`, process each item, push to returnData

## Key Patterns
- **Binary data**: Use `this.helpers.getBinaryDataBuffer(itemIndex, propertyName)` for files
- **Credentials**: Access via `await this.getCredentials('name')`, destructure accessKeyId/secretAccessKey
- **Error handling**: `if (this.continueOnFail())` for graceful failure, else `throw new NodeOperationError`
- **AWS SDK v3**: Initialize clients with region and credentials object, use async send() on commands

## Development Workflow
- **npm run dev**: Start n8n with hot-reload for testing nodes
- **npm run build**: Compile TypeScript to dist/ using n8n-node build
- **npm run lint**: Check code style with n8n's ESLint config
- **npm run release**: Publish to npm via release-it

## Conventions
- **TypeScript strict mode**: Enabled, use explicit types, no any
- **Imports**: From 'n8n-workflow' for core types, AWS SDK clients as needed
- **Node naming**: camelCase in code, displayName for UI
- **Properties**: Use displayOptions.show for conditional fields
- **File handling**: Support both binary data and base64 strings, detect MIME types

## Common Gotchas
- **Item processing**: Always handle multiple items, use itemIndex in getNodeParameter
- **Binary properties**: Assert existence with assertBinaryData before accessing
- **AWS regions**: Make configurable, default to common regions like eu-central-1
- **Async operations**: All I/O is async, use await consistently
- **Output format**: Return [{json: {...}}] for single output, multiple arrays for branching

## Example Node Structure
```typescript
export class MyNode implements INodeType {
  description: INodeTypeDescription = {
    // ... properties, credentials, etc.
  };

  async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
    const items = this.getInputData();
    const returnData: INodeExecutionData[] = [];

    for (let i = 0; i < items.length; i++) {
      // Process each item
      returnData.push({ json: { result: 'data' } });
    }

    return [returnData];
  }
}
```</content>
<parameter name="filePath">/Users/cigogma/Projects/n8n-custom-node/n8n-bedrock-content-extraction/.github/copilot-instructions.md